<!DOCTYPE HTML>
<html lang="[object]" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>nix-shell</title>
        

        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../custom.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../quick-start.html"><strong aria-hidden="true">2.</strong> Quick Start</a></li><li class="chapter-item expanded "><a href="../installation/installation.html"><strong aria-hidden="true">3.</strong> Installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/supported-platforms.html"><strong aria-hidden="true">3.1.</strong> Supported Platforms</a></li><li class="chapter-item expanded "><a href="../installation/installing-binary.html"><strong aria-hidden="true">3.2.</strong> Installing a Binary Distribution</a></li><li class="chapter-item expanded "><a href="../installation/installing-source.html"><strong aria-hidden="true">3.3.</strong> Installing Nix from Source</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/prerequisites-source.html"><strong aria-hidden="true">3.3.1.</strong> Prerequisites</a></li><li class="chapter-item expanded "><a href="../installation/obtaining-source.html"><strong aria-hidden="true">3.3.2.</strong> Obtaining a Source Distribution</a></li><li class="chapter-item expanded "><a href="../installation/building-source.html"><strong aria-hidden="true">3.3.3.</strong> Building Nix from Source</a></li></ol></li><li class="chapter-item expanded "><a href="../installation/installing-docker.html"><strong aria-hidden="true">3.4.</strong> Using Nix within Docker</a></li><li class="chapter-item expanded "><a href="../installation/nix-security.html"><strong aria-hidden="true">3.5.</strong> Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/single-user.html"><strong aria-hidden="true">3.5.1.</strong> Single-User Mode</a></li><li class="chapter-item expanded "><a href="../installation/multi-user.html"><strong aria-hidden="true">3.5.2.</strong> Multi-User Mode</a></li></ol></li><li class="chapter-item expanded "><a href="../installation/env-variables.html"><strong aria-hidden="true">3.6.</strong> Environment Variables</a></li><li class="chapter-item expanded "><a href="../installation/upgrading.html"><strong aria-hidden="true">3.7.</strong> Upgrading Nix</a></li></ol></li><li class="chapter-item expanded "><a href="../package-management/package-management.html"><strong aria-hidden="true">4.</strong> Package Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../package-management/basic-package-mgmt.html"><strong aria-hidden="true">4.1.</strong> Basic Package Management</a></li><li class="chapter-item expanded "><a href="../package-management/profiles.html"><strong aria-hidden="true">4.2.</strong> Profiles</a></li><li class="chapter-item expanded "><a href="../package-management/garbage-collection.html"><strong aria-hidden="true">4.3.</strong> Garbage Collection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../package-management/garbage-collector-roots.html"><strong aria-hidden="true">4.3.1.</strong> Garbage Collector Roots</a></li></ol></li><li class="chapter-item expanded "><a href="../package-management/channels.html"><strong aria-hidden="true">4.4.</strong> Channels</a></li><li class="chapter-item expanded "><a href="../package-management/sharing-packages.html"><strong aria-hidden="true">4.5.</strong> Sharing Packages Between Machines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../package-management/binary-cache-substituter.html"><strong aria-hidden="true">4.5.1.</strong> Serving a Nix store via HTTP</a></li><li class="chapter-item expanded "><a href="../package-management/copy-closure.html"><strong aria-hidden="true">4.5.2.</strong> Copying Closures via SSH</a></li><li class="chapter-item expanded "><a href="../package-management/ssh-substituter.html"><strong aria-hidden="true">4.5.3.</strong> Serving a Nix store via SSH</a></li><li class="chapter-item expanded "><a href="../package-management/s3-substituter.html"><strong aria-hidden="true">4.5.4.</strong> Serving a Nix store via S3</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../language/index.html"><strong aria-hidden="true">5.</strong> Nix Language</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/values.html"><strong aria-hidden="true">5.1.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="../language/constructs.html"><strong aria-hidden="true">5.2.</strong> Language Constructs</a></li><li class="chapter-item expanded "><a href="../language/operators.html"><strong aria-hidden="true">5.3.</strong> Operators</a></li><li class="chapter-item expanded "><a href="../language/derivations.html"><strong aria-hidden="true">5.4.</strong> Derivations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/advanced-attributes.html"><strong aria-hidden="true">5.4.1.</strong> Advanced Attributes</a></li></ol></li><li class="chapter-item expanded "><a href="../language/builtin-constants.html"><strong aria-hidden="true">5.5.</strong> Built-in Constants</a></li><li class="chapter-item expanded "><a href="../language/builtins.html"><strong aria-hidden="true">5.6.</strong> Built-in Functions</a></li></ol></li><li class="chapter-item expanded "><a href="../advanced-topics/advanced-topics.html"><strong aria-hidden="true">6.</strong> Advanced Topics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced-topics/distributed-builds.html"><strong aria-hidden="true">6.1.</strong> Remote Builds</a></li><li class="chapter-item expanded "><a href="../advanced-topics/cores-vs-jobs.html"><strong aria-hidden="true">6.2.</strong> Tuning Cores and Jobs</a></li><li class="chapter-item expanded "><a href="../advanced-topics/diff-hook.html"><strong aria-hidden="true">6.3.</strong> Verifying Build Reproducibility</a></li><li class="chapter-item expanded "><a href="../advanced-topics/post-build-hook.html"><strong aria-hidden="true">6.4.</strong> Using the post-build-hook</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/command-ref.html"><strong aria-hidden="true">7.</strong> Command Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/opt-common.html"><strong aria-hidden="true">7.1.</strong> Common Options</a></li><li class="chapter-item expanded "><a href="../command-ref/env-common.html"><strong aria-hidden="true">7.2.</strong> Common Environment Variables</a></li><li class="chapter-item expanded "><a href="../command-ref/main-commands.html"><strong aria-hidden="true">7.3.</strong> Main Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/nix-env.html"><strong aria-hidden="true">7.3.1.</strong> nix-env</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-build.html"><strong aria-hidden="true">7.3.2.</strong> nix-build</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-shell.html" class="active"><strong aria-hidden="true">7.3.3.</strong> nix-shell</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-store.html"><strong aria-hidden="true">7.3.4.</strong> nix-store</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/utilities.html"><strong aria-hidden="true">7.4.</strong> Utilities</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/nix-channel.html"><strong aria-hidden="true">7.4.1.</strong> nix-channel</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-collect-garbage.html"><strong aria-hidden="true">7.4.2.</strong> nix-collect-garbage</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-copy-closure.html"><strong aria-hidden="true">7.4.3.</strong> nix-copy-closure</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-daemon.html"><strong aria-hidden="true">7.4.4.</strong> nix-daemon</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-hash.html"><strong aria-hidden="true">7.4.5.</strong> nix-hash</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-instantiate.html"><strong aria-hidden="true">7.4.6.</strong> nix-instantiate</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-prefetch-url.html"><strong aria-hidden="true">7.4.7.</strong> nix-prefetch-url</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/experimental-commands.html"><strong aria-hidden="true">7.5.</strong> Experimental Commands</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/files.html"><strong aria-hidden="true">8.</strong> Files</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/conf-file.html"><strong aria-hidden="true">8.1.</strong> nix.conf</a></li></ol></li><li class="chapter-item expanded "><a href="../glossary.html"><strong aria-hidden="true">9.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../contributing/contributing.html"><strong aria-hidden="true">10.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../contributing/hacking.html"><strong aria-hidden="true">10.1.</strong> Hacking</a></li><li class="chapter-item expanded "><a href="../contributing/cli-guideline.html"><strong aria-hidden="true">10.2.</strong> CLI guideline</a></li></ol></li><li class="chapter-item expanded "><a href="../release-notes/release-notes.html"><strong aria-hidden="true">11.</strong> Release Notes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../release-notes/rl-next.html"><strong aria-hidden="true">11.1.</strong> Release X.Y (202?-??-??)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.10.html"><strong aria-hidden="true">11.2.</strong> Release 2.10 (2022-07-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.9.html"><strong aria-hidden="true">11.3.</strong> Release 2.9 (2022-05-30)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.8.html"><strong aria-hidden="true">11.4.</strong> Release 2.8 (2022-04-19)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.7.html"><strong aria-hidden="true">11.5.</strong> Release 2.7 (2022-03-07)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.6.html"><strong aria-hidden="true">11.6.</strong> Release 2.6 (2022-01-24)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.5.html"><strong aria-hidden="true">11.7.</strong> Release 2.5 (2021-12-13)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.4.html"><strong aria-hidden="true">11.8.</strong> Release 2.4 (2021-11-01)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.3.html"><strong aria-hidden="true">11.9.</strong> Release 2.3 (2019-09-04)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.2.html"><strong aria-hidden="true">11.10.</strong> Release 2.2 (2019-01-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.1.html"><strong aria-hidden="true">11.11.</strong> Release 2.1 (2018-09-02)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.0.html"><strong aria-hidden="true">11.12.</strong> Release 2.0 (2018-02-22)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.11.10.html"><strong aria-hidden="true">11.13.</strong> Release 1.11.10 (2017-06-12)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.11.html"><strong aria-hidden="true">11.14.</strong> Release 1.11 (2016-01-19)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.10.html"><strong aria-hidden="true">11.15.</strong> Release 1.10 (2015-09-03)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.9.html"><strong aria-hidden="true">11.16.</strong> Release 1.9 (2015-06-12)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.8.html"><strong aria-hidden="true">11.17.</strong> Release 1.8 (2014-12-14)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.7.html"><strong aria-hidden="true">11.18.</strong> Release 1.7 (2014-04-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.6.1.html"><strong aria-hidden="true">11.19.</strong> Release 1.6.1 (2013-10-28)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.6.html"><strong aria-hidden="true">11.20.</strong> Release 1.6 (2013-09-10)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.5.2.html"><strong aria-hidden="true">11.21.</strong> Release 1.5.2 (2013-05-13)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.5.html"><strong aria-hidden="true">11.22.</strong> Release 1.5 (2013-02-27)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.4.html"><strong aria-hidden="true">11.23.</strong> Release 1.4 (2013-02-26)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.3.html"><strong aria-hidden="true">11.24.</strong> Release 1.3 (2013-01-04)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.2.html"><strong aria-hidden="true">11.25.</strong> Release 1.2 (2012-12-06)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.1.html"><strong aria-hidden="true">11.26.</strong> Release 1.1 (2012-07-18)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.0.html"><strong aria-hidden="true">11.27.</strong> Release 1.0 (2012-05-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.16.html"><strong aria-hidden="true">11.28.</strong> Release 0.16 (2010-08-17)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.15.html"><strong aria-hidden="true">11.29.</strong> Release 0.15 (2010-03-17)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.14.html"><strong aria-hidden="true">11.30.</strong> Release 0.14 (2010-02-04)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.13.html"><strong aria-hidden="true">11.31.</strong> Release 0.13 (2009-11-05)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.12.html"><strong aria-hidden="true">11.32.</strong> Release 0.12 (2008-11-20)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.11.html"><strong aria-hidden="true">11.33.</strong> Release 0.11 (2007-12-31)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.10.1.html"><strong aria-hidden="true">11.34.</strong> Release 0.10.1 (2006-10-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.10.html"><strong aria-hidden="true">11.35.</strong> Release 0.10 (2006-10-06)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.9.2.html"><strong aria-hidden="true">11.36.</strong> Release 0.9.2 (2005-09-21)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.9.1.html"><strong aria-hidden="true">11.37.</strong> Release 0.9.1 (2005-09-20)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.9.html"><strong aria-hidden="true">11.38.</strong> Release 0.9 (2005-09-16)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.8.1.html"><strong aria-hidden="true">11.39.</strong> Release 0.8.1 (2005-04-13)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.8.html"><strong aria-hidden="true">11.40.</strong> Release 0.8 (2005-04-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.7.html"><strong aria-hidden="true">11.41.</strong> Release 0.7 (2005-01-12)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.6.html"><strong aria-hidden="true">11.42.</strong> Release 0.6 (2004-11-14)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.5.html"><strong aria-hidden="true">11.43.</strong> Release 0.5 and earlier</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Handle use selecting locale option -->
                <script type="text/javascript">
                    document.querySelector('#locale-list').addEventListener('change', function () {
                        window.location = this.value;
                    })
                </script>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#name" id="name">Name</a></h1>
<p><code>nix-shell</code> - start an interactive shell based on a Nix expression</p>
<h1><a class="header" href="#synopsis" id="synopsis">Synopsis</a></h1>
<p><code>nix-shell</code>
[<code>--arg</code> <em>name</em> <em>value</em>]
[<code>--argstr</code> <em>name</em> <em>value</em>]
[{<code>--attr</code> | <code>-A</code>} <em>attrPath</em>]
[<code>--command</code> <em>cmd</em>]
[<code>--run</code> <em>cmd</em>]
[<code>--exclude</code> <em>regexp</em>]
[<code>--pure</code>]
[<code>--keep</code> <em>name</em>]</p>
<h1><a class="header" href="#disambiguation" id="disambiguation">Disambiguation</a></h1>
<p>This man page describes the command <code>nix-shell</code>, which is distinct from <code>nix shell</code>. For documentation on the latter, run <code>nix shell --help</code> or see <code>man nix3-shell</code>.</p>
<h1><a class="header" href="#description" id="description">Description</a></h1>
<p>The command <code>nix-shell</code> will build the dependencies of the specified
derivation, but not the derivation itself. It will then start an
interactive shell in which all environment variables defined by the
derivation <em>path</em> have been set to their corresponding values, and the
script <code>$stdenv/setup</code> has been sourced. This is useful for reproducing
the environment of a derivation for development.</p>
<p>If <em>path</em> is not given, <code>nix-shell</code> defaults to <code>shell.nix</code> if it
exists, and <code>default.nix</code> otherwise.</p>
<p>If <em>path</em> starts with <code>http://</code> or <code>https://</code>, it is interpreted as the
URL of a tarball that will be downloaded and unpacked to a temporary
location. The tarball must include a single top-level directory
containing at least a file named <code>default.nix</code>.</p>
<p>If the derivation defines the variable <code>shellHook</code>, it will be run
after <code>$stdenv/setup</code> has been sourced. Since this hook is not executed
by regular Nix builds, it allows you to perform initialisation specific
to <code>nix-shell</code>. For example, the derivation attribute</p>
<pre><code class="language-nix">shellHook =
  ''
    echo &quot;Hello shell&quot;
    export SOME_API_TOKEN=&quot;$(cat ~/.config/some-app/api-token)&quot;
  '';
</code></pre>
<p>will cause <code>nix-shell</code> to print <code>Hello shell</code> and set the <code>SOME_API_TOKEN</code>
environment variable to a user-configured value.</p>
<h1><a class="header" href="#options" id="options">Options</a></h1>
<p>All options not listed here are passed to <code>nix-store --realise</code>, except for <code>--arg</code> and <code>--attr</code> / <code>-A</code> which are passed to
<code>nix-instantiate</code>.</p>
<ul>
<li>
<p><code>--command</code> <em>cmd</em><br />
In the environment of the derivation, run the shell command <em>cmd</em>.
This command is executed in an interactive shell. (Use <code>--run</code> to
use a non-interactive shell instead.) However, a call to <code>exit</code> is
implicitly added to the command, so the shell will exit after
running the command. To prevent this, add <code>return</code> at the end;
e.g.  <code>--command &quot;echo Hello; return&quot;</code> will print <code>Hello</code> and then
drop you into the interactive shell. This can be useful for doing
any additional initialisation.</p>
</li>
<li>
<p><code>--run</code> <em>cmd</em><br />
Like <code>--command</code>, but executes the command in a non-interactive
shell. This means (among other things) that if you hit Ctrl-C while
the command is running, the shell exits.</p>
</li>
<li>
<p><code>--exclude</code> <em>regexp</em><br />
Do not build any dependencies whose store path matches the regular
expression <em>regexp</em>. This option may be specified multiple times.</p>
</li>
<li>
<p><code>--pure</code><br />
If this flag is specified, the environment is almost entirely
cleared before the interactive shell is started, so you get an
environment that more closely corresponds to the “real” Nix build. A
few variables, in particular <code>HOME</code>, <code>USER</code> and <code>DISPLAY</code>, are
retained.</p>
</li>
<li>
<p><code>--packages</code> / <code>-p</code> <em>packages</em>…<br />
Set up an environment in which the specified packages are present.
The command line arguments are interpreted as attribute names inside
the Nix Packages collection. Thus, <code>nix-shell -p libjpeg openjdk</code>
will start a shell in which the packages denoted by the attribute
names <code>libjpeg</code> and <code>openjdk</code> are present.</p>
</li>
<li>
<p><code>-i</code> <em>interpreter</em><br />
The chained script interpreter to be invoked by <code>nix-shell</code>. Only
applicable in <code>#!</code>-scripts (described below).</p>
</li>
<li>
<p><code>--keep</code> <em>name</em><br />
When a <code>--pure</code> shell is started, keep the listed environment
variables.</p>
</li>
</ul>
<p>The following common options are supported:</p>
<h1><a class="header" href="#environment-variables" id="environment-variables">Environment variables</a></h1>
<ul>
<li><code>NIX_BUILD_SHELL</code><br />
Shell used to start the interactive environment. Defaults to the
<code>bash</code> found in <code>&lt;nixpkgs&gt;</code>, falling back to the <code>bash</code> found in
<code>PATH</code> if not found.</li>
</ul>
<h1><a class="header" href="#examples" id="examples">Examples</a></h1>
<p>To build the dependencies of the package Pan, and start an interactive
shell in which to build it:</p>
<pre><code class="language-console">$ nix-shell '&lt;nixpkgs&gt;' -A pan
[nix-shell]$ eval ${unpackPhase:-unpackPhase}
[nix-shell]$ cd pan-*
[nix-shell]$ eval ${configurePhase:-configurePhase}
[nix-shell]$ eval ${buildPhase:-buildPhase}
[nix-shell]$ ./pan/gui/pan
</code></pre>
<p>The reason we use form <code>eval ${configurePhase:-configurePhase}</code> here is because
those packages that override these phases do so by exporting the overridden
values in the environment variable of the same name.
Here bash is being told to either evaluate the contents of 'configurePhase',
if it exists as a variable, otherwise evaluate the configurePhase function.</p>
<p>To clear the environment first, and do some additional automatic
initialisation of the interactive shell:</p>
<pre><code class="language-console">$ nix-shell '&lt;nixpkgs&gt;' -A pan --pure \
    --command 'export NIX_DEBUG=1; export NIX_CORES=8; return'
</code></pre>
<p>Nix expressions can also be given on the command line using the <code>-E</code> and
<code>-p</code> flags. For instance, the following starts a shell containing the
packages <code>sqlite</code> and <code>libX11</code>:</p>
<pre><code class="language-console">$ nix-shell -E 'with import &lt;nixpkgs&gt; { }; runCommand &quot;dummy&quot; { buildInputs = [ sqlite xorg.libX11 ]; } &quot;&quot;'
</code></pre>
<p>A shorter way to do the same is:</p>
<pre><code class="language-console">$ nix-shell -p sqlite xorg.libX11
[nix-shell]$ echo $NIX_LDFLAGS
… -L/nix/store/j1zg5v…-sqlite-3.8.0.2/lib -L/nix/store/0gmcz9…-libX11-1.6.1/lib …
</code></pre>
<p>Note that <code>-p</code> accepts multiple full nix expressions that are valid in
the <code>buildInputs = [ ... ]</code> shown above, not only package names. So the
following is also legal:</p>
<pre><code class="language-console">$ nix-shell -p sqlite 'git.override { withManual = false; }'
</code></pre>
<p>The <code>-p</code> flag looks up Nixpkgs in the Nix search path. You can override
it by passing <code>-I</code> or setting <code>NIX_PATH</code>. For example, the following
gives you a shell containing the Pan package from a specific revision of
Nixpkgs:</p>
<pre><code class="language-console">$ nix-shell -p pan -I nixpkgs=https://github.com/NixOS/nixpkgs/archive/8a3eea054838b55aca962c3fbde9c83c102b8bf2.tar.gz

[nix-shell:~]$ pan --version
Pan 0.139
</code></pre>
<h1><a class="header" href="#use-as-a--interpreter" id="use-as-a--interpreter">Use as a <code>#!</code>-interpreter</a></h1>
<p>You can use <code>nix-shell</code> as a script interpreter to allow scripts written
in arbitrary languages to obtain their own dependencies via Nix. This is
done by starting the script with the following lines:</p>
<pre><code class="language-bash">#! /usr/bin/env nix-shell
#! nix-shell -i real-interpreter -p packages
</code></pre>
<p>where <em>real-interpreter</em> is the “real” script interpreter that will be
invoked by <code>nix-shell</code> after it has obtained the dependencies and
initialised the environment, and <em>packages</em> are the attribute names of
the dependencies in Nixpkgs.</p>
<p>The lines starting with <code>#! nix-shell</code> specify <code>nix-shell</code> options (see
above). Note that you cannot write <code>#! /usr/bin/env nix-shell -i ...</code>
because many operating systems only allow one argument in <code>#!</code> lines.</p>
<p>For example, here is a Python script that depends on Python and the
<code>prettytable</code> package:</p>
<pre><code class="language-python">#! /usr/bin/env nix-shell
#! nix-shell -i python -p python pythonPackages.prettytable

import prettytable

# Print a simple table.
t = prettytable.PrettyTable([&quot;N&quot;, &quot;N^2&quot;])
for n in range(1, 10): t.add_row([n, n * n])
print t
</code></pre>
<p>Similarly, the following is a Perl script that specifies that it
requires Perl and the <code>HTML::TokeParser::Simple</code> and <code>LWP</code> packages:</p>
<pre><code class="language-perl">#! /usr/bin/env nix-shell
#! nix-shell -i perl -p perl perlPackages.HTMLTokeParserSimple perlPackages.LWP

use HTML::TokeParser::Simple;

# Fetch nixos.org and print all hrefs.
my $p = HTML::TokeParser::Simple-&gt;new(url =&gt; 'http://nixos.org/');

while (my $token = $p-&gt;get_tag(&quot;a&quot;)) {
    my $href = $token-&gt;get_attr(&quot;href&quot;);
    print &quot;$href\n&quot; if $href;
}
</code></pre>
<p>Sometimes you need to pass a simple Nix expression to customize a
package like Terraform:</p>
<pre><code class="language-bash">#! /usr/bin/env nix-shell
#! nix-shell -i bash -p &quot;terraform.withPlugins (plugins: [ plugins.openstack ])&quot;

terraform apply
</code></pre>
<blockquote>
<p><strong>Note</strong></p>
<p>You must use double quotes (<code>&quot;</code>) when passing a simple Nix expression
in a nix-shell shebang.</p>
</blockquote>
<p>Finally, using the merging of multiple nix-shell shebangs the following
Haskell script uses a specific branch of Nixpkgs/NixOS (the 20.03 stable
branch):</p>
<pre><code class="language-haskell">#! /usr/bin/env nix-shell
#! nix-shell -i runghc -p &quot;haskellPackages.ghcWithPackages (ps: [ps.download-curl ps.tagsoup])&quot;
#! nix-shell -I nixpkgs=https://github.com/NixOS/nixpkgs/archive/nixos-20.03.tar.gz

import Network.Curl.Download
import Text.HTML.TagSoup
import Data.Either
import Data.ByteString.Char8 (unpack)

-- Fetch nixos.org and print all hrefs.
main = do
  resp &lt;- openURI &quot;https://nixos.org/&quot;
  let tags = filter (isTagOpenName &quot;a&quot;) $ parseTags $ unpack $ fromRight undefined resp
  let tags' = map (fromAttrib &quot;href&quot;) tags
  mapM_ putStrLn $ filter (/= &quot;&quot;) tags'
</code></pre>
<p>If you want to be even more precise, you can specify a specific revision
of Nixpkgs:</p>
<pre><code>#! nix-shell -I nixpkgs=https://github.com/NixOS/nixpkgs/archive/0672315759b3e15e2121365f067c1c8c56bb4722.tar.gz
</code></pre>
<p>The examples above all used <code>-p</code> to get dependencies from Nixpkgs. You
can also use a Nix expression to build your own dependencies. For
example, the Python example could have been written as:</p>
<pre><code class="language-python">#! /usr/bin/env nix-shell
#! nix-shell deps.nix -i python
</code></pre>
<p>where the file <code>deps.nix</code> in the same directory as the <code>#!</code>-script
contains:</p>
<pre><code class="language-nix">with import &lt;nixpkgs&gt; {};

runCommand &quot;dummy&quot; { buildInputs = [ python pythonPackages.prettytable ]; } &quot;&quot;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../command-ref/nix-build.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../command-ref/nix-store.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../command-ref/nix-build.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../command-ref/nix-store.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../redirects.js"></script>
        

        

    </body>
</html>
